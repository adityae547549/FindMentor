<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Mentor Settings | FindMentor</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,system-ui,sans-serif}
:root{
  --bg:#f9fafb;
  --card:#ffffff;
  --border:#e5e7eb;
  --text:#111827;
  --muted:#6b7280;
  --accent:#0d9488;
}
body{background:var(--bg);color:var(--text)}

header{
  background:#fff;
  border-bottom:1px solid var(--border)
}
.header-inner{
  max-width:800px;
  margin:auto;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center
}
.logo{font-weight:700}
.logo span{color:var(--accent)}
.back{
  background:none;
  border:1px solid var(--border);
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer
}

main{
  max-width:800px;
  margin:32px auto;
  padding:0 20px
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:24px
}

h1{margin-bottom:6px}
p.subtitle{color:var(--muted);margin-bottom:24px}

label{
  font-size:.85rem;
  color:var(--muted);
  display:block;
  margin-bottom:6px
}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  margin-bottom:18px
}

/* SUBJECT CHECKBOXES */
.checkbox-group{
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:14px 24px;
  margin-bottom:20px
}
.checkbox-item{
  display:flex;
  align-items:center;
  gap:10px
}
.checkbox-item input{
  width:16px;height:16px;cursor:pointer
}
.checkbox-item label{
  font-size:.95rem;cursor:pointer
}

button.save{
  background:var(--accent);
  color:#fff;
  border:none;
  padding:12px 18px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer
}

#status{
  margin-top:14px;
  font-size:.9rem;
  color:green;
  display:none
}
</style>
</head>

<body>

<header>
  <div class="header-inner">
    <div class="logo">Find<span>Mentor</span></div>
    <button class="back" onclick="goBack()">← Dashboard</button>
  </div>
</header>

<main>
  <div class="card">
    <h1>Mentor Settings</h1>
    <p class="subtitle">Manage your teaching profile.</p>

    <!-- NAME -->
    <label>Full Name</label>
    <input id="name" placeholder="Your name" />

    <!-- SUBJECTS -->
    <label>Subjects You Teach</label>
    <div class="checkbox-group">
      <div class="checkbox-item"><input id="mentor-subject-maths" type="checkbox" value="maths"><label for="mentor-subject-maths">Mathematics</label></div>
      <div class="checkbox-item"><input id="mentor-subject-physics" type="checkbox" value="physics"><label for="mentor-subject-physics">Physics</label></div>
      <div class="checkbox-item"><input id="mentor-subject-chemistry" type="checkbox" value="chemistry"><label for="mentor-subject-chemistry">Chemistry</label></div>
      <div class="checkbox-item"><input id="mentor-subject-biology" type="checkbox" value="biology"><label for="mentor-subject-biology">Biology</label></div>
      <div class="checkbox-item"><input id="mentor-subject-cs" type="checkbox" value="cs"><label for="mentor-subject-cs">Computer Science</label></div>
      <div class="checkbox-item"><input id="mentor-subject-other" type="checkbox" value="other"><label for="mentor-subject-other">General</label></div>
    </div>

    <button class="save" onclick="saveSettings()">Save Changes</button>
    <div id="status">✅ Settings saved successfully</div>
  </div>
</main>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyD6gXvi6bmPd5GCKQ-1kZ66YPCb-A34tqo",
  authDomain: "studio-6680101022-359df.firebaseapp.com",
  projectId: "studio-6680101022-359df",
  storageBucket: "studio-6680101022-359df.firebasestorage.app",
  messagingSenderId: "938584797960",
  appId: "1:938584797960:web:e57f885a6be9bb4deab2bd"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser;
const nameInput = document.getElementById("name");
const statusDiv = document.getElementById("status");

/* AUTH GUARD + LOAD */
onAuthStateChanged(auth, async user => {
  if (!user) return location.href = "login.html";
  currentUser = user;
  loadSettings();
});

/* LOAD SETTINGS */
async function loadSettings(){
  const ref = doc(db,"users",currentUser.uid);
  const snap = await getDoc(ref);
  if(!snap.exists()) return;

  const d = snap.data();
  nameInput.value = d.name || "";

  if(d.subjects){
    document.querySelectorAll(".checkbox-group input")
      .forEach(cb => cb.checked = d.subjects.includes(cb.value));
  }
}

/* SAVE SETTINGS */
window.saveSettings = async () => {
  if (!nameInput.value.trim()) {
    alert("Name cannot be empty");
    return;
  }

  const subjects = [...document.querySelectorAll(".checkbox-group input")]
    .filter(cb => cb.checked)
    .map(cb => cb.value);

  await setDoc(
    doc(db,"users",currentUser.uid),
    {
      name: nameInput.value.trim(),
      subjects,
      role: "mentor"
    },
    { merge:true }
  );

  statusDiv.style.display = "block";
  setTimeout(()=>statusDiv.style.display="none",2500);
};

/* NAV */
window.goBack = () => location.href = "mentor-dashboard.html";
</script>

</body>
</html>
